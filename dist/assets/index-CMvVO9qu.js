import{useRouter as J}from"./vue-router-Ds9KUoJm.js";import{_ as L}from"./BaseButton-WTmgFy-8.js";import{c as K,b as f}from"./index-BHIUWM3O.js";import{_ as O}from"./form-DIvwc75X.js";import{a as B,b as k,f as $}from"./selectOptionFetcher-DRGeyH0g.js";import{g as Q,r as v,w as W,o as X,aj as U,a as Z,e as ee,i as P,O as x,D as b,M as V,C as q,n as A}from"./@vue-D5jJVPgi.js";import"./pinia-BWRdMQcg.js";import"./bootstrap-r_TW8pGT.js";import"./@popperjs-BEKk9TLb.js";import"./bootstrap-vue-next-CI7J1iGq.js";import"./izitoast-CqdWWGAA.js";import"./sweetalert2-89IKscqO.js";import"./@fortawesome-BMRTUbaC.js";import"./jspdf-BHjgPkY0.js";import"./@babel-BgpAVVkQ.js";import"./fflate-DE92GPtl.js";import"./@vueuse-BFKO5FPz.js";import"./xlsx-VQGdcWwX.js";import"./jspdf-autotable-DwCSpOYb.js";import"./@tsparticles-RHRfPQQI.js";import"./pinia-plugin-persistedstate-BuM6D3kL.js";import"./destr-BPvN1X9m.js";import"./deep-pick-omit-CegYQlcN.js";import"./lodash-CW-aI5JM.js";import"./crypto-js-C9xuVu9R.js";import"./axios-xsH4HHeE.js";import"./qs-Dop67Io4.js";import"./side-channel-DfNisRws.js";import"./es-errors-CxTyLFAO.js";import"./object-inspect-CwG9orBb.js";import"./side-channel-list-CVgrowBt.js";import"./side-channel-map-Czb7NFry.js";import"./get-intrinsic-BpLglCTt.js";import"./es-object-atoms-BR76m4z7.js";import"./math-intrinsics-DP1tGiab.js";import"./gopd-C1lCZ5Qs.js";import"./es-define-property-D_7cP-M3.js";import"./has-symbols-BaUvM3gb.js";import"./get-proto-Cd0SCNDH.js";import"./dunder-proto-DSwuxXkl.js";import"./call-bind-apply-helpers-VtLnLD2e.js";import"./function-bind-CHqF18-c.js";import"./hasown-DwiY0sux.js";import"./call-bound-BuGV4nFB.js";import"./side-channel-weakmap-DmcBNuf_.js";import"./smooth-scrollbar-CSiRJ_Pw.js";import"./core-js-BA3D9nVJ.js";import"./@vueform-b-21xuRD.js";import"./vue3-circle-progress-DRe7pzrA.js";import"./vue-Aiaqh0QQ.js";import"./vue3-apexcharts-CSHbnzTQ.js";import"./apexcharts-AYwITVQt.js";/* empty css                                                                  *//* empty css                                                                  */import"./SelectComponent-CyRHSQTW.js";const te={class:"card p-3"},ae={class:"row d-flex justify-content-between align-items-center mb-3"},oe={class:"col-auto mb-4"},re="/v1/project/project-expenses",it={__name:"index",setup(ne){const{proxy:j}=Q(),_=J(),o=K(),{data:r,request:g,refresh:C,isLoading:N,error:M}=f(re,{method:"GET",options:{},autoFetch:!1}),l=v({data:[],paginationData:{countOnPage:0,currentPage:1,perPage:20,totalCount:0,totalPages:0,paginationLinks:{}}}),h=v([]),p=v([]),u=v([]),R=[{key:"project_name",label:"Project"},{key:"expense_name",label:"Expenses"},{key:"total_amount",label:"Expense Amount"},{key:"contributed_amount",label:"Contributed Amount"}];W(r,()=>{w()});const w=()=>{var t;if((t=r.value)!=null&&t.dataPayload){const e=r.value.dataPayload.data;let a=[];typeof e=="object"&&!Array.isArray(e)?a=Object.values(e):Array.isArray(e)&&(a=e),l.value={data:a,paginationData:{countOnPage:r.value.dataPayload.countOnPage||0,currentPage:r.value.dataPayload.currentPage||1,perPage:r.value.dataPayload.perPage||l.value.paginationData.perPage,totalCount:r.value.dataPayload.totalCount||0,totalPages:r.value.dataPayload.totalPages||0,paginationLinks:r.value.dataPayload.paginationLinks||{}}}}},F=async t=>{var c,i;const e=t.id;if(o.toggleModalUsage(!0),await A(),!o.useModal){_.push({name:"project/projectexpense/view",params:{id:e}});return}const a=`/v1/project/project-expense/${e}`,{data:n,request:s,isLoading:y,error:m}=f(a,{method:"GET",options:{},autoFetch:!0});await s(),h.value=await $(),p.value=await B(),u.value=await k(),o.openModal(O,{formData:((i=(c=n.value)==null?void 0:c.dataPayload)==null?void 0:i.data)||{},error:m,financierOptions:h.value,expenseOptions:p.value,projectOptions:u.value,isLoading:y,readonly:!0,hideSubmit:!0},"View ProjectExpense")},d=v({}),G=async t=>{var c,i;const e=t.id;if(d.value={},o.toggleModalUsage(!0),await A(),!o.useModal){_.push({name:"project/projectexpense/update",params:{id:e}});return}const a=`/v1/project/project-expense/${e}`,{data:n,request:s,isLoading:y}=f(a,{method:"GET",options:{},autoFetch:!0,autoAlert:!0});await s(),h.value=await $(),p.value=await B(),u.value=await k();const m=async D=>{const{request:T,error:E}=f(a,{method:"PUT"});if(await T(D),E.value){console.log("Error",E.value),d.value=E.value;return}o.closeModal(),C()};o.openModal(O,{formData:((i=(c=n.value)==null?void 0:c.dataPayload)==null?void 0:i.data)||{},error:d,context:"Edit",financierOptions:h.value,expenseOptions:p.value,projectOptions:u.value,isLoading:y,readonly:!1,hideSubmit:!1,onSubmit:m},"Edit ProjectExpense")},S=async()=>{if(d.value={},o.toggleModalUsage(!0),await A(),p.value=await B(),u.value=await k(),!o.useModal){_.push({name:"project/projectexpense/create"});return}const t=async e=>{const a="/v1/project/project-expense",{request:n,error:s}=f(a,{method:"POST",autoAlert:!0});if(await n(e),s.value){console.log("Error",s.value),d.value=s.value;return}o.closeModal(),C()};o.openModal(O,{formData:{},error:d,expenseOptions:p.value,projectOptions:u.value,isLoading:!1,readonly:!1,hideSubmit:!1,onSubmit:t},"Add Project Expense")},Y=async t=>{var m,c;const e=t.id,a=t.is_deleted,n=a?"Restore":"Delete",s=a?"You are about to restore this record. Do you want to proceed?":"You are about to delete this record. Do you want to proceed?";if((await j.$showAlert({title:"Are you sure?",text:s,icon:"warning",showConfirmButton:!0,confirmButtonText:`Yes, ${n} it!`,cancelButtonText:"No, cancel!",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",reverseButtons:!0})).isConfirmed)try{const{data:i,request:D,isLoading:T}=f(`/v1/project/project-expense/${e}`,{method:"DELETE"});await D(),i.value&&await j.$showAlert({title:`${n}d!`,text:((c=(m=i.value)==null?void 0:m.alertifyPayload)==null?void 0:c.message)||"Record deleted successfully",icon:"success",showCancelButton:!1,showConfirmButton:!1,timer:1500})}catch{console.error("Error deleting record:",M),await j.$showAlert({title:"Error!",text:`Error deleting record: ${M.value}`,icon:"error",showCancelButton:!1})}finally{await C()}else console.log("Deletion cancelled")},z=t=>{g(null,{page:l.value.paginationData.currentPage,"per-page":l.value.paginationData.perPage,q:t})},I=async t=>{await g(null,{page:t,"per-page":l.value.paginationData.perPage}),w(),console.log("Page changed to: ",r.value)},H=async t=>{l.value.paginationData.perPage=t,await g(null,{page:l.value.paginationData.currentPage,"per-page":t}),w()};return X(()=>{g().then(()=>{w()})}),(t,e)=>{const a=U("font-awesome-icon"),n=U("OmniGridView");return ee(),Z("div",te,[P("div",ae,[e[2]||(e[2]=P("div",{class:"col-auto"},[P("h1",{class:"h4 mt-2"},"List of ProjectExpense")],-1)),P("div",oe,[x(L,{type:"submit",customClass:"btn btn-primary",onClick:S},{default:b(()=>e[0]||(e[0]=[V(" New ProjectExpense ")])),_:1})]),x(n,{columns:R,data:l.value,loading:q(N),"action-layout":"inline","pagination-config":{variant:"circle",position:"right",bgColor:"#4f46e5",hoverBgColor:"#6366f1",textColor:"#374151",activeTextColor:"#ffffff",showFirstLast:!0,showNumbers:!0,showTotal:!0,showRange:!0},toolbar:{show:!0,showCreateButton:!1},"expandable-rows":!1,filtering:!1,rowSize:"sm",striped:!1,"multi-select":!1,"radio-select":!1,"break-extra-columns":!1,"search-in-backend":!0,onView:F,onEdit:G,onDelete:Y,onSearch:z,onChangePage:I,"onUpdate:perPage":H,onRefresh:q(g)},{"left-buttons":b(()=>[x(L,{class:"btn btn-success btn-sm",onClick:S,style:{"font-size":"1.2rem"}},{icon:b(()=>[x(a,{icon:["fas","plus"]})]),default:b(()=>[e[1]||(e[1]=V(" New ProjectExpense "))]),_:1})]),_:1},8,["data","loading","onRefresh"])])])}}};export{it as default};
