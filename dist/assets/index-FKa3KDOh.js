import{aq as R,ac as G,aw as Y,af as f,ag as S,as as z,ax as I,aj as T,a3 as H,a4 as J,a5 as h,a7 as v,a8 as w,a9 as j,ah as k,ay as D}from"./index-CTt-D8ZI.js";import{_ as A}from"./BaseButton-Ci7rrm8T.js";import{_ as x}from"./form-CARbB_Gk.js";/* empty css                                                                  */const K={class:"card p-3"},Q={class:"row d-flex justify-content-between align-items-center mb-3"},W={class:"col-auto mb-4"},X="/v1/project/financiers",na={__name:"index",setup(Z){const{proxy:y}=R(),P=G(),o=Y(),{data:n,request:p,refresh:b,isLoading:L,error:B}=f(X,{method:"GET",options:{},autoFetch:!1}),l=S({data:[],paginationData:{countOnPage:0,currentPage:1,perPage:20,totalCount:0,totalPages:0,paginationLinks:{}}}),$=[{key:"name",label:"Name"},{key:"contact",label:"Contact"}];z(n,()=>{g()});const g=()=>{var e;if((e=n.value)!=null&&e.dataPayload){const a=n.value.dataPayload.data;let t=[];typeof a=="object"&&!Array.isArray(a)?t=Object.values(a):Array.isArray(a)&&(t=a),l.value={data:t,paginationData:{countOnPage:n.value.dataPayload.countOnPage||0,currentPage:n.value.dataPayload.currentPage||1,perPage:n.value.dataPayload.perPage||l.value.paginationData.perPage,totalCount:n.value.dataPayload.totalCount||0,totalPages:n.value.dataPayload.totalPages||0,paginationLinks:n.value.dataPayload.paginationLinks||{}}}}},F=async e=>{var c,i;const a=e.id;if(o.toggleModalUsage(!0),await D(),!o.useModal){P.push({name:"project/financier/view",params:{id:a}});return}const t=`/v1/project/financier/${a}`,{data:r,request:s,isLoading:m,error:d}=f(t,{method:"GET",options:{},autoFetch:!0});await s(),o.openModal(x,{formData:((i=(c=r.value)==null?void 0:c.dataPayload)==null?void 0:i.data)||{},error:d,isLoading:m,readonly:!0,hideSubmit:!0},"View Financier")},u=S({}),U=async e=>{var c,i;const a=e.id;if(u.value={},o.toggleModalUsage(!0),await D(),!o.useModal){P.push({name:"project/financier/update",params:{id:a}});return}const t=`/v1/project/financier/${a}`,{data:r,request:s,isLoading:m}=f(t,{method:"GET",options:{},autoFetch:!0,autoAlert:!0});await s();const d=async C=>{const{request:M,error:_}=f(t,{method:"PUT"});if(await M(C),_.value){console.log("Error",_.value),u.value=_.value;return}o.closeModal(),b()};o.openModal(x,{formData:((i=(c=r.value)==null?void 0:c.dataPayload)==null?void 0:i.data)||{},error:u,isLoading:m,readonly:!1,hideSubmit:!1,onSubmit:d},"Edit Financier")},E=async()=>{if(u.value={},o.toggleModalUsage(!0),await D(),!o.useModal){P.push({name:"project/financier/create"});return}const e=async a=>{const t="/v1/project/financier",{request:r,error:s}=f(t,{method:"POST",autoAlert:!0});if(await r(a),s.value){console.log("Error",s.value),u.value=s.value;return}o.closeModal(),b()};o.openModal(x,{formData:{},error:u,isLoading:!1,readonly:!1,hideSubmit:!1,onSubmit:e},"Create Financier")},q=async e=>{var d,c;const a=e.id,t=e.is_deleted,r=t?"Restore":"Delete",s=t?"You are about to restore this record. Do you want to proceed?":"You are about to delete this record. Do you want to proceed?";if((await y.$showAlert({title:"Are you sure?",text:s,icon:"warning",showConfirmButton:!0,confirmButtonText:`Yes, ${r} it!`,cancelButtonText:"No, cancel!",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",reverseButtons:!0})).isConfirmed)try{const{data:i,request:C,isLoading:M}=f(`/v1/project/financier/${a}`,{method:"DELETE"});await C(),i.value&&await y.$showAlert({title:`${r}d!`,text:((c=(d=i.value)==null?void 0:d.alertifyPayload)==null?void 0:c.message)||"Record deleted successfully",icon:"success",showCancelButton:!1,showConfirmButton:!1,timer:1500})}catch{console.error("Error deleting record:",B),await y.$showAlert({title:"Error!",text:`Error deleting record: ${B.value}`,icon:"error",showCancelButton:!1})}finally{await b()}else console.log("Deletion cancelled")},N=e=>{p(null,{page:l.value.paginationData.currentPage,"per-page":l.value.paginationData.perPage,q:e})},V=async e=>{await p(null,{page:e,"per-page":l.value.paginationData.perPage}),g(),console.log("Page changed to: ",n.value)},O=async e=>{l.value.paginationData.perPage=e,await p(null,{page:l.value.paginationData.currentPage,"per-page":e}),g()};return I(()=>{p().then(()=>{g()})}),(e,a)=>{const t=T("font-awesome-icon"),r=T("OmniGridView");return J(),H("div",K,[h("div",Q,[a[2]||(a[2]=h("div",{class:"col-auto"},[h("h1",{class:"h4 mt-2"},"List of Financier")],-1)),h("div",W,[v(A,{type:"submit",customClass:"btn btn-primary",onClick:E},{default:w(()=>a[0]||(a[0]=[j(" New Financier ")])),_:1})]),v(r,{columns:$,data:l.value,loading:k(L),"action-layout":"inline","pagination-config":{variant:"circle",position:"right",bgColor:"#4f46e5",hoverBgColor:"#6366f1",textColor:"#374151",activeTextColor:"#ffffff",showFirstLast:!0,showNumbers:!0,showTotal:!0,showRange:!0},toolbar:{show:!0,showCreateButton:!1},"expandable-rows":!1,filtering:!1,rowSize:"sm",striped:!1,"multi-select":!1,"radio-select":!1,"break-extra-columns":!1,"search-in-backend":!0,onView:F,onEdit:U,onDelete:q,onSearch:N,onChangePage:V,"onUpdate:perPage":O,onRefresh:k(p)},{"left-buttons":w(()=>[v(A,{class:"btn btn-success btn-sm",onClick:E,style:{"font-size":"1.2rem"}},{icon:w(()=>[v(t,{icon:["fas","plus"]})]),default:w(()=>[a[1]||(a[1]=j(" New Financier "))]),_:1})]),_:1},8,["data","loading","onRefresh"])])])}}};export{na as default};
