import{useRouter as I}from"./vue-router-Ds9KUoJm.js";import{_ as A}from"./BaseButton-WTmgFy-8.js";import{c as H,b as m}from"./index-B8O5Qf7z.js";import{_}from"./form-BgevoGCW.js";import{A as J}from"./AssignmentManager-DP0svaiG.js";import{g as K,r as k,w as Q,o as W,aj as G,a as X,e as Z,i as v,O as w,D as y,M as S,C as T,n as x}from"./@vue-D5jJVPgi.js";import"./pinia-BWRdMQcg.js";import"./bootstrap-r_TW8pGT.js";import"./@popperjs-BEKk9TLb.js";import"./bootstrap-vue-next-CI7J1iGq.js";import"./izitoast-CqdWWGAA.js";import"./sweetalert2-89IKscqO.js";import"./@fortawesome-BMRTUbaC.js";import"./jspdf-BHjgPkY0.js";import"./@babel-BgpAVVkQ.js";import"./fflate-DE92GPtl.js";import"./@vueuse-BFKO5FPz.js";import"./xlsx-VQGdcWwX.js";import"./jspdf-autotable-DwCSpOYb.js";import"./@tsparticles-RHRfPQQI.js";import"./pinia-plugin-persistedstate-BuM6D3kL.js";import"./destr-BPvN1X9m.js";import"./deep-pick-omit-CegYQlcN.js";import"./lodash-CW-aI5JM.js";import"./crypto-js-C9xuVu9R.js";import"./axios-xsH4HHeE.js";import"./qs-Dop67Io4.js";import"./side-channel-DfNisRws.js";import"./es-errors-CxTyLFAO.js";import"./object-inspect-CwG9orBb.js";import"./side-channel-list-CVgrowBt.js";import"./side-channel-map-Czb7NFry.js";import"./get-intrinsic-BpLglCTt.js";import"./es-object-atoms-BR76m4z7.js";import"./math-intrinsics-DP1tGiab.js";import"./gopd-C1lCZ5Qs.js";import"./es-define-property-D_7cP-M3.js";import"./has-symbols-BaUvM3gb.js";import"./get-proto-Cd0SCNDH.js";import"./dunder-proto-DSwuxXkl.js";import"./call-bind-apply-helpers-VtLnLD2e.js";import"./function-bind-CHqF18-c.js";import"./hasown-DwiY0sux.js";import"./call-bound-BuGV4nFB.js";import"./side-channel-weakmap-DmcBNuf_.js";import"./smooth-scrollbar-CSiRJ_Pw.js";import"./core-js-BA3D9nVJ.js";import"./@vueform-b-21xuRD.js";import"./vue3-circle-progress-DRe7pzrA.js";import"./vue-Aiaqh0QQ.js";import"./vue3-apexcharts-CSHbnzTQ.js";import"./apexcharts-AYwITVQt.js";import"./BaseInput-DScbu7ZB.js";/* empty css                                                                  */import"./BaseLabel-CWbc88nK.js";/* empty css                                                                  */const ee={class:"card p-3"},ae={class:"row d-flex justify-content-between align-items-center mb-3"},te={class:"col-auto mb-4"},oe="/v1/iam/rbac/groups",ia={__name:"index",setup(re){const{proxy:d}=K(),b=I(),o=H(),{data:r,request:g,refresh:P,isLoading:L,error:B}=m(oe,{method:"GET",options:{},autoFetch:!1}),l=k({data:[],paginationData:{countOnPage:0,currentPage:1,perPage:20,totalCount:0,totalPages:0,paginationLinks:{}}}),R=[{key:"name",label:"Name"},{key:"description",label:"Description"}];Q(r,()=>{f()});const f=()=>{var e;if((e=r.value)!=null&&e.dataPayload){const a=r.value.dataPayload.data;let t=[];typeof a=="object"&&!Array.isArray(a)?t=Object.values(a):Array.isArray(a)&&(t=a),l.value={data:t,paginationData:{countOnPage:r.value.dataPayload.countOnPage||0,currentPage:r.value.dataPayload.currentPage||1,perPage:r.value.dataPayload.perPage||l.value.paginationData.perPage,totalCount:r.value.dataPayload.totalCount||0,totalPages:r.value.dataPayload.totalPages||0,paginationLinks:r.value.dataPayload.paginationLinks||{}}}}},U=async e=>{var u,i;const a=e.name;if(o.toggleModalUsage(!0),await x(),!o.useModal){b.push({name:"iam/groups/view",params:{id:a}});return}const t=`/v1/iam/rbac/group/${a}`,{data:s,request:n,isLoading:h,error:p}=m(t,{method:"GET",options:{},autoFtech:!0});await n(),o.openModal(_,{formData:((i=(u=s.value)==null?void 0:u.dataPayload)==null?void 0:i.data)||{},error:p,isLoading:h,readonly:!0,hideSubmit:!0},"View Groups")},c=k({}),O=async e=>{var u,i;const a=e.name;if(c.value={},o.toggleModalUsage(!0),await x(),!o.useModal){b.push({name:"iam/groups/update",params:{id:a}});return}const t=`/v1/iam/rbac/group/${a}`,{data:s,request:n,isLoading:h}=m(t,{method:"GET",options:{},autoFtech:!0});await n();const p=async C=>{var $;const{data:M,request:z,error:D}=m(t,{method:"PUT"});if(await z(C),D.value){console.log("Error",D.value),c.value=D.value;return}o.closeModal(),d.$showAlert({title:"Success",icon:"success",text:(($=M.value)==null?void 0:$.alertifypayload.message)??"Group Updated successfully",showConfirmButton:!1,timer:2e3,timerProgressBar:!0}),P()};o.openModal(_,{formData:((i=(u=s.value)==null?void 0:u.dataPayload)==null?void 0:i.data)||{},error:c,isLoading:h,readonly:!1,hideSubmit:!1,onSubmit:p},"Edit Groups")},E=async()=>{if(c.value={},o.toggleModalUsage(!0),await x(),!o.useModal){b.push({name:"iam/groups/create"});return}const e=async a=>{const t="/v1/iam/rbac/group",{request:s,error:n}=m(t,{method:"POST"});if(await s(a),n.value){console.log("Error",n.value),c.value=n.value;return}o.closeModal(),d.$showAlert({title:"Success",icon:"success",text:"Groups Created successfully",showConfirmButton:!1,timer:2e3,timerProgressBar:!0}),P()};o.openModal(_,{formData:{},error:c,isLoading:!1,readonly:!1,hideSubmit:!1,onSubmit:e},"Create Groups")},N=async e=>{var p,u;const a=e.name,t=e.is_deleted,s=t?"Restore":"Delete",n=t?"You are about to restore this record. Do you want to proceed?":"You are about to delete this record. Do you want to proceed?";if((await d.$showAlert({title:"Are you sure?",text:n,icon:"warning",showConfirmButton:!0,confirmButtonText:`Yes, ${s} it!`,cancelButtonText:"No, cancel!",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",reverseButtons:!0})).isConfirmed)try{const{data:i,request:C,isLoading:M}=m(`/v1/iam/rbac/group/${a}`,{method:"DELETE"});await C(),i.value&&await d.$showAlert({title:`${s}d!`,text:((u=(p=i.value)==null?void 0:p.toastPayload)==null?void 0:u.toastMessage)||"Record deleted successfully",icon:"success",showCancelButton:!1,showConfirmButton:!1,timer:1500})}catch{console.error("Error deleting record:",B),await d.$showAlert({title:"Error!",text:`Error deleting record: ${B.value}`,icon:"error",showCancelButton:!1})}finally{await P()}else console.log("Deletion cancelled")},V=e=>{g(null,{page:l.value.paginationData.currentPage,"per-page":l.value.paginationData.perPage,_search:e})},q=async e=>{await g(null,{page:e,"per-page":l.value.paginationData.perPage}),f(),console.log("Page changed to: ",r.value)},F=async e=>{l.value.paginationData.perPage=e,await g(null,{page:l.value.paginationData.currentPage,"per-page":e}),f()};W(()=>{g().then(()=>{f()})});const j=e=>{o.openModal(J,{entity:e,config:{title:"roles",availableTitle:"Roles",assignedTitle:"Roles",keyField:"name",displayField:"name",getAllEndpoint:"/v1/iam/rbac/roles",getAssignedEndpoint:`/v1/iam/rbac/group/assign/${e.name}`,assignEndpoint:`/v1/iam/rbac/group/assign/${e.name}`,removeEndpoint:`/v1/iam/rbac/group/remove/${e.name}`}},`Manage Roles for ${e.name}`,"xl",!1,{centered:!1,scrollable:!0})},Y=[{key:"manage-group",label:"Manage",icon:["fas","user-group"],callback:e=>j(e),show:!0,colorClass:"text-secondary "}];return(e,a)=>{const t=G("font-awesome-icon"),s=G("OmniGridView");return Z(),X("div",ee,[v("div",ae,[a[2]||(a[2]=v("div",{class:"col-auto"},[v("h1",{class:"h4 mt-2"},"List of Groups")],-1)),v("div",te,[w(A,{type:"submit",customClass:"btn btn-primary",onClick:E},{default:y(()=>a[0]||(a[0]=[S(" New Group ")])),_:1})]),w(s,{columns:R,data:l.value,loading:T(L),dropDownPerPageOptions:[10,25,50],actions:Y,"action-layout":"inline",title:"Group","pagination-config":{variant:"circle",position:"right",bgColor:"#4f46e5",hoverBgColor:"#6366f1",textColor:"#374151",activeTextColor:"#ffffff",showFirstLast:!0,showNumbers:!0,showTotal:!0,showRange:!0},toolbar:{show:!1,showCreateButton:!0},"expandable-rows":!1,filtering:!1,rowSize:"sm",striped:!1,"multi-select":!1,"radio-select":!1,"break-extra-columns":!0,"search-in-backend":!0,onView:U,onEdit:O,onDelete:N,onSearch:V,onChangePage:q,"onUpdate:perPage":F,onRefresh:T(g)},{"left-buttons":y(()=>[w(A,{class:"btn btn-success btn-sm",onClick:E,style:{"font-size":"1.2rem"}},{icon:y(()=>[w(t,{icon:["fas","plus"]})]),default:y(()=>[a[1]||(a[1]=S(" New Group "))]),_:1})]),_:1},8,["data","loading","onRefresh"])])])}}};export{ia as default};
