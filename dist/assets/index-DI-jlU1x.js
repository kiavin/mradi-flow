import{useRouter as G}from"./vue-router-Ds9KUoJm.js";import{_ as S}from"./BaseButton-WTmgFy-8.js";import{c as z,b as f}from"./index-BhZ2WKwH.js";import{_ as N}from"./form-D6FzOkkU.js";import{g as J,r as $,w as H,o as I,aj as E,a as K,e as Q,i as w,O as _,D as y,M as k,q as W,x as X,C as T,n as M}from"./@vue-D5jJVPgi.js";import"./pinia-BWRdMQcg.js";import"./bootstrap-r_TW8pGT.js";import"./@popperjs-BEKk9TLb.js";import"./bootstrap-vue-next-CI7J1iGq.js";import"./izitoast-CqdWWGAA.js";import"./sweetalert2-89IKscqO.js";import"./@fortawesome-BMRTUbaC.js";import"./jspdf-BHjgPkY0.js";import"./@babel-BgpAVVkQ.js";import"./fflate-DE92GPtl.js";import"./@vueuse-BFKO5FPz.js";import"./xlsx-VQGdcWwX.js";import"./jspdf-autotable-DwCSpOYb.js";import"./@tsparticles-RHRfPQQI.js";import"./pinia-plugin-persistedstate-BuM6D3kL.js";import"./destr-BPvN1X9m.js";import"./deep-pick-omit-CegYQlcN.js";import"./lodash-CW-aI5JM.js";import"./crypto-js-C9xuVu9R.js";import"./axios-xsH4HHeE.js";import"./qs-Dop67Io4.js";import"./side-channel-DfNisRws.js";import"./es-errors-CxTyLFAO.js";import"./object-inspect-CwG9orBb.js";import"./side-channel-list-CVgrowBt.js";import"./side-channel-map-Czb7NFry.js";import"./get-intrinsic-BpLglCTt.js";import"./es-object-atoms-BR76m4z7.js";import"./math-intrinsics-DP1tGiab.js";import"./gopd-C1lCZ5Qs.js";import"./es-define-property-D_7cP-M3.js";import"./has-symbols-BaUvM3gb.js";import"./get-proto-Cd0SCNDH.js";import"./dunder-proto-DSwuxXkl.js";import"./call-bind-apply-helpers-VtLnLD2e.js";import"./function-bind-CHqF18-c.js";import"./hasown-DwiY0sux.js";import"./call-bound-BuGV4nFB.js";import"./side-channel-weakmap-DmcBNuf_.js";import"./smooth-scrollbar-CSiRJ_Pw.js";import"./core-js-BA3D9nVJ.js";import"./@vueform-b-21xuRD.js";import"./vue3-circle-progress-DRe7pzrA.js";import"./vue-Aiaqh0QQ.js";import"./vue3-apexcharts-CSHbnzTQ.js";import"./apexcharts-AYwITVQt.js";import"./BaseInput-Ca9A5ndL.js";/* empty css                                                                  */import"./BaseLabel-DfXAOOTf.js";/* empty css                                                                  */const Z={class:"card p-3"},ee={class:"row d-flex justify-content-between align-items-center mb-3"},te={class:"col-auto mb-4"},ae="/v1/iam/users",st={__name:"index",setup(oe){const{proxy:d}=J(),B=G(),m=z(),{data:n,request:g,refresh:v,isLoading:R,error:b}=f(ae,{method:"GET",options:{},autoFetch:!1}),u=$({data:[],paginationData:{countOnPage:0,currentPage:1,perPage:20,totalCount:0,totalPages:0,paginationLinks:{}}}),L=[{key:"first_name",label:"First Name",formatter:(a,e)=>{var t;return((t=e.profile)==null?void 0:t.first_name)||"N/A"}},{key:"middle_name",label:"Middle Name",formatter:(a,e)=>{var t;return((t=e.profile)==null?void 0:t.middle_name)||"N/A"}},{key:"last_name",label:"Last Name",formatter:(a,e)=>{var t;return((t=e.profile)==null?void 0:t.last_name)||"N/A"}},{key:"username",label:"Username"},{key:"email_address",label:"Email",formatter:(a,e)=>{var t;return((t=e.profile)==null?void 0:t.email_address)||"N/A"}},{key:"phone_number",label:"Phone Number",formatter:(a,e)=>{var t;return((t=e.profile)==null?void 0:t.phone_number)||"N/A"}},{key:"recordStatus",label:"Status",formatter:(a,e)=>{var t,o;return((o=(t=e.profile)==null?void 0:t.recordStatus)==null?void 0:o.label)||"N/A"}}];H(n,()=>{P()});const P=()=>{var a;if((a=n.value)!=null&&a.dataPayload){const e=n.value.dataPayload.data;let t=[];typeof e=="object"&&!Array.isArray(e)?t=Object.values(e):Array.isArray(e)&&(t=e),u.value={data:t,paginationData:{countOnPage:n.value.dataPayload.countOnPage||0,currentPage:n.value.dataPayload.currentPage||1,perPage:n.value.dataPayload.perPage||u.value.paginationData.perPage,totalCount:n.value.dataPayload.totalCount||0,totalPages:n.value.dataPayload.totalPages||0,paginationLinks:n.value.dataPayload.paginationLinks||{}}},console.log("Updated tableData:",JSON.parse(JSON.stringify(u.value)))}},p=$({}),O=async a=>{var s,c;const e=a.username;if(p.value={},m.toggleModalUsage(!0),await M(),!m.useModal){B.push({name:"iam/users",params:{id:e}});return}const t=`/v1/iam/user/${e}`,{data:o,request:i,isLoading:l}=f(t,{method:"GET",options:{},autoFetch:!0});await i();const r=async h=>{var A;const{data:C,request:j,error:D}=f(t,{method:"PUT"});if(await j(h),D.value){console.log("Error",D.value),p.value=D.value;return}m.closeModal(),d.$showAlert({title:"Success",icon:"success",text:((A=C.value)==null?void 0:A.alertifyPayload.message)??"Users Updated successfully",showConfirmButton:!1,timer:2e3,timerProgressBar:!0}),v()};m.openModal(N,{formData:((c=(s=o.value)==null?void 0:s.dataPayload)==null?void 0:c.data)||{},error:p,isLoading:l,context:"edit",readonly:!1,hideSubmit:!1,onSubmit:r},"Edit Financier")},x=async()=>{if(p.value={},m.toggleModalUsage(!0),await M(),!m.useModal){B.push({name:"iam/users"});return}const a=async e=>{var r,s;const t="/v1/iam/auth/register";console.log("newdata",e);const{data:o,request:i,error:l}=f(t,{method:"POST"});if(await i(e),l.value){console.log("Error",l.value),p.value=l.value;return}m.closeModal(),d.$showAlert({title:"Success",icon:"success",text:((s=(r=o.value)==null?void 0:r.alertifyPayload)==null?void 0:s.message)??"Role Created successfully",showConfirmButton:!1,timer:2e3,timerProgressBar:!0}),v()};m.openModal(N,{formData:{},error:p,isLoading:!1,context:"create",readonly:!1,hideSubmit:!1,onSubmit:a},"Add Financier")},U=async a=>{var r,s;const e=a.username,t=a.is_deleted,o=t?"Restore":"Delete",i=t?"You are about to restore this record. Do you want to proceed?":"You are about to delete this record. Do you want to proceed?";if((await d.$showAlert({title:"Are you sure?",text:i,icon:"warning",showConfirmButton:!0,confirmButtonText:`Yes, ${o} it!`,cancelButtonText:"No, cancel!",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",reverseButtons:!0})).isConfirmed)try{const{data:c,request:h,isLoading:C}=f(`/v1/iam/user/${e}`,{method:"DELETE"});await h(),c.value&&await d.$showAlert({title:`${o}d!`,text:((s=(r=c.value)==null?void 0:r.toastPayload)==null?void 0:s.toastMessage)||"Record deleted successfully",icon:"success",showCancelButton:!1,showConfirmButton:!1,timer:1500})}catch{console.error("Error deleting record:",b),await d.$showAlert({title:"Error!",text:`Error deleting record: ${b.value}`,icon:"error",showCancelButton:!1})}finally{await v()}else console.log("Deletion cancelled")},F=async a=>{var r,s;const e=a.username,t=a.is_deleted,o=t?"Restore":"Delete",i=t?"You are about to restore this record. Do you want to proceed?":"You are about to delete this record. Do you want to proceed?";if((await d.$showAlert({title:"Are you sure?",text:i,icon:"warning",showConfirmButton:!0,confirmButtonText:`Yes, ${o} it!`,cancelButtonText:"No, cancel!",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",reverseButtons:!0})).isConfirmed)try{const{data:c,request:h,isLoading:C}=f(`/v1/iam/user/${e}`,{method:"PATCH"});await h(),c.value&&await d.$showAlert({title:`${o}d!`,text:((s=(r=c.value)==null?void 0:r.toastPayload)==null?void 0:s.toastMessage)||"Record deleted successfully",icon:"success",showCancelButton:!1,showConfirmButton:!1,timer:1500})}catch{console.error("Error deleting record:",b),await d.$showAlert({title:"Error!",text:`Error deleting record: ${b.value}`,icon:"error",showCancelButton:!1})}finally{await v()}else console.log("Deletion cancelled")},V=a=>{g(null,{page:u.value.paginationData.currentPage,"per-page":u.value.paginationData.perPage,_search:a})},q=async a=>{await g(null,{page:a,"per-page":u.value.paginationData.perPage}),P(),console.log("Page changed to: ",n.value)},Y=async a=>{u.value.paginationData.perPage=a,await g(null,{page:u.value.paginationData.currentPage,"per-page":a}),P()};return I(()=>{g().then(()=>{P()})}),(a,e)=>{const t=E("font-awesome-icon"),o=E("OmniGridView");return Q(),K("div",Z,[w("div",ee,[e[2]||(e[2]=w("div",{class:"col-auto"},[w("h1",{class:"h4 mt-2"},"Financiers")],-1)),w("div",te,[_(S,{type:"submit",customClass:"btn btn-primary",onClick:x},{default:y(()=>e[0]||(e[0]=[k(" Add Finacier ")])),_:1})]),_(o,{columns:L,data:u.value,loading:T(R),"action-layout":"inline","pagination-config":{variant:"circle",position:"right",bgColor:"#4f46e5",hoverBgColor:"#6366f1",textColor:"#374151",activeTextColor:"#ffffff",showFirstLast:!0,showNumbers:!0,showTotal:!0,showRange:!0},toolbar:{show:!1},"expandable-rows":!1,filtering:!1,rowSize:"sm",striped:!1,dropDownPerPageOptions:[5,10,25,50],"multi-select":!1,"radio-select":!1,"break-extra-columns":!1,"search-in-backend":!0,showView:!1,showEdit:!0,showDelete:!0,actions:a.customAction,onView:a.handleView,onEdit:O,onDelete:U,onRestore:F,onSearch:V,onChangePage:q,"onUpdate:perPage":Y,onRefresh:T(g)},{"left-buttons":y(()=>[_(S,{class:"btn btn-success btn-sm",onClick:x,style:{"font-size":"1.2rem"}},{icon:y(()=>[_(t,{icon:["fas","plus"]})]),default:y(()=>[e[1]||(e[1]=k(" New Financier "))]),_:1})]),"column-recordStatus":y(({row:i})=>{var l,r;return[w("span",{class:W(["badge",`bg-${((l=i.profile.recordStatus)==null?void 0:l.theme)||"secondary"}`])},X(((r=i.profile.recordStatus)==null?void 0:r.label)||"N/A"),3)]}),_:1},8,["data","loading","actions","onView","onRefresh"])])])}}};export{st as default};
