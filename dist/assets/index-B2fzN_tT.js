import{useRouter as z}from"./vue-router-Ds9KUoJm.js";import{_ as A}from"./BaseButton-WTmgFy-8.js";import{c as J,b as p}from"./index-BHIUWM3O.js";import{_ as x}from"./form-7B2h2BLn.js";import{g as H,r as M,w as I,o as K,aj as T,a as Q,e as W,i as w,O as C,D as y,M as U,q as X,x as Z,C as k,n as S}from"./@vue-D5jJVPgi.js";import"./pinia-BWRdMQcg.js";import"./bootstrap-r_TW8pGT.js";import"./@popperjs-BEKk9TLb.js";import"./bootstrap-vue-next-CI7J1iGq.js";import"./izitoast-CqdWWGAA.js";import"./sweetalert2-89IKscqO.js";import"./@fortawesome-BMRTUbaC.js";import"./jspdf-BHjgPkY0.js";import"./@babel-BgpAVVkQ.js";import"./fflate-DE92GPtl.js";import"./@vueuse-BFKO5FPz.js";import"./xlsx-VQGdcWwX.js";import"./jspdf-autotable-DwCSpOYb.js";import"./@tsparticles-RHRfPQQI.js";import"./pinia-plugin-persistedstate-BuM6D3kL.js";import"./destr-BPvN1X9m.js";import"./deep-pick-omit-CegYQlcN.js";import"./lodash-CW-aI5JM.js";import"./crypto-js-C9xuVu9R.js";import"./axios-xsH4HHeE.js";import"./qs-Dop67Io4.js";import"./side-channel-DfNisRws.js";import"./es-errors-CxTyLFAO.js";import"./object-inspect-CwG9orBb.js";import"./side-channel-list-CVgrowBt.js";import"./side-channel-map-Czb7NFry.js";import"./get-intrinsic-BpLglCTt.js";import"./es-object-atoms-BR76m4z7.js";import"./math-intrinsics-DP1tGiab.js";import"./gopd-C1lCZ5Qs.js";import"./es-define-property-D_7cP-M3.js";import"./has-symbols-BaUvM3gb.js";import"./get-proto-Cd0SCNDH.js";import"./dunder-proto-DSwuxXkl.js";import"./call-bind-apply-helpers-VtLnLD2e.js";import"./function-bind-CHqF18-c.js";import"./hasown-DwiY0sux.js";import"./call-bound-BuGV4nFB.js";import"./side-channel-weakmap-DmcBNuf_.js";import"./smooth-scrollbar-CSiRJ_Pw.js";import"./core-js-BA3D9nVJ.js";import"./@vueform-b-21xuRD.js";import"./vue3-circle-progress-DRe7pzrA.js";import"./vue-Aiaqh0QQ.js";import"./vue3-apexcharts-CSHbnzTQ.js";import"./apexcharts-AYwITVQt.js";import"./BaseInput-CVO1slZQ.js";/* empty css                                                                  */import"./BaseLabel-CLga4Mrz.js";/* empty css                                                                  */const ee={class:"card p-3"},te={class:"row d-flex justify-content-between align-items-center mb-3"},ae={class:"col-auto mb-4"},oe="/v1/admin/profiles",nt={__name:"index",setup(re){const{proxy:m}=H(),D=z(),c=J(),{data:u,request:g,refresh:v,isLoading:N,error:b}=p(oe,{method:"GET",options:{},autoFetch:!1}),d=M({data:[],paginationData:{countOnPage:0,currentPage:1,perPage:20,totalCount:0,totalPages:0,paginationLinks:{}}}),L=[{key:"first_name",label:"First Name"},{key:"middle_name",label:"Middle Name"},{key:"last_name",label:"Last Name"},{key:"email_address",label:"Email"},{key:"phone_number",label:"Phone Number"},{key:"recordStatus",label:"Status",formatter:e=>(e==null?void 0:e.label)||"N/A"}];I(u,()=>{P()});const P=()=>{var e;if((e=u.value)!=null&&e.dataPayload){const t=u.value.dataPayload.data;let a=[];typeof t=="object"&&!Array.isArray(t)?a=Object.values(t):Array.isArray(t)&&(a=t),d.value={data:a,paginationData:{countOnPage:u.value.dataPayload.countOnPage||0,currentPage:u.value.dataPayload.currentPage||1,perPage:u.value.dataPayload.perPage||d.value.paginationData.perPage,totalCount:u.value.dataPayload.totalCount||0,totalPages:u.value.dataPayload.totalPages||0,paginationLinks:u.value.dataPayload.paginationLinks||{}}},console.log("Updated tableData:",JSON.parse(JSON.stringify(d.value)))}},R=async e=>{var r,n;const t=e.name;if(c.toggleModalUsage(!0),await S(),!c.useModal){D.push({name:"iam/users",params:{id:t}});return}const a=`/v1/iam/users/${t}`,{data:s,request:i,isLoading:l,error:o}=p(a,{method:"GET",options:{},autoFetch:!0});await i(),c.openModal(x,{formData:((n=(r=s.value)==null?void 0:r.dataPayload)==null?void 0:n.data)||{},error:o,isLoading:l,readonly:!0,hideSubmit:!0},"View Role")},f=M({}),O=async e=>{var r,n;const t=e.id;if(f.value={},c.toggleModalUsage(!0),await S(),!c.useModal){D.push({name:"iam/users",params:{id:t}});return}const a=`/v1/admin/profile/${t}`,{data:s,request:i,isLoading:l}=p(a,{method:"GET",options:{},autoFetch:!0});await i();const o=async h=>{var E;const{data:_,request:j,error:B}=p(a,{method:"PUT"});if(await j(h),B.value){console.log("Error",B.value),f.value=B.value;return}c.closeModal(),m.$showAlert({title:"Success",icon:"success",text:((E=_.value)==null?void 0:E.alertifyPayload.message)??"Users Updated successfully",showConfirmButton:!1,timer:2e3,timerProgressBar:!0}),v()};c.openModal(x,{formData:((n=(r=s.value)==null?void 0:r.dataPayload)==null?void 0:n.data)||{},error:f,isLoading:l,context:"edit",readonly:!1,hideSubmit:!1,onSubmit:o},"Edit User")},$=async()=>{if(f.value={},c.toggleModalUsage(!0),await S(),!c.useModal){D.push({name:"iam/users"});return}const e=async t=>{var o,r;const a="/v1/iam/auth/register",{data:s,request:i,error:l}=p(a,{method:"POST"});if(await i(t),l.value){console.log("Error",l.value),f.value=l.value;return}c.closeModal(),m.$showAlert({title:"Success",icon:"success",text:((r=(o=s.value)==null?void 0:o.alertifyPayload)==null?void 0:r.message)??"Role Created successfully",showConfirmButton:!1,timer:2e3,timerProgressBar:!0}),v()};c.openModal(x,{formData:{},error:f,isLoading:!1,readonly:!1,hideSubmit:!1,onSubmit:e},"Create User")},V=async e=>{var o,r;const t=e.id,a=e.is_deleted,s=a?"Restore":"Delete",i=a?"You are about to restore this record. Do you want to proceed?":"You are about to delete this record. Do you want to proceed?";if((await m.$showAlert({title:"Are you sure?",text:i,icon:"warning",showConfirmButton:!0,confirmButtonText:`Yes, ${s} it!`,cancelButtonText:"No, cancel!",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",reverseButtons:!0})).isConfirmed)try{const{data:n,request:h,isLoading:_}=p(`/v1/admin/profile/${t}`,{method:"DELETE"});await h(),n.value&&await m.$showAlert({title:`${s}d!`,text:((r=(o=n.value)==null?void 0:o.toastPayload)==null?void 0:r.toastMessage)||"Record deleted successfully",icon:"success",showCancelButton:!1,showConfirmButton:!1,timer:1500})}catch{console.error("Error deleting record:",b),await m.$showAlert({title:"Error!",text:`Error deleting record: ${b.value}`,icon:"error",showCancelButton:!1})}finally{await v()}else console.log("Deletion cancelled")},q=async e=>{var o,r;const t=e.id,a=e.is_deleted,s=a?"Restore":"Delete",i=a?"You are about to restore this record. Do you want to proceed?":"You are about to delete this record. Do you want to proceed?";if((await m.$showAlert({title:"Are you sure?",text:i,icon:"warning",showConfirmButton:!0,confirmButtonText:`Yes, ${s} it!`,cancelButtonText:"No, cancel!",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",reverseButtons:!0})).isConfirmed)try{const{data:n,request:h,isLoading:_}=p(`/v1/admin/profile/${t}`,{method:"PATCH"});await h(),n.value&&await m.$showAlert({title:`${s}d!`,text:((r=(o=n.value)==null?void 0:o.toastPayload)==null?void 0:r.toastMessage)||"Record deleted successfully",icon:"success",showCancelButton:!1,showConfirmButton:!1,timer:1500})}catch{console.error("Error deleting record:",b),await m.$showAlert({title:"Error!",text:`Error deleting record: ${b.value}`,icon:"error",showCancelButton:!1})}finally{await v()}else console.log("Deletion cancelled")},Y=e=>{g(null,{page:d.value.paginationData.currentPage,"per-page":d.value.paginationData.perPage,_search:e})},F=async e=>{await g(null,{page:e,"per-page":d.value.paginationData.perPage}),P(),console.log("Page changed to: ",u.value)},G=async e=>{d.value.paginationData.perPage=e,await g(null,{page:d.value.paginationData.currentPage,"per-page":e}),P()};return K(()=>{g().then(()=>{P()})}),(e,t)=>{const a=T("font-awesome-icon"),s=T("OmniGridView");return W(),Q("div",ee,[w("div",te,[t[2]||(t[2]=w("div",{class:"col-auto"},[w("h1",{class:"h4 mt-2"},"List of Users")],-1)),w("div",ae,[C(A,{type:"submit",customClass:"btn btn-primary",onClick:$},{default:y(()=>t[0]||(t[0]=[U(" New User ")])),_:1})]),C(s,{columns:L,data:d.value,loading:k(N),"action-layout":"inline","pagination-config":{variant:"circle",position:"right",bgColor:"#4f46e5",hoverBgColor:"#6366f1",textColor:"#374151",activeTextColor:"#ffffff",showFirstLast:!0,showNumbers:!0,showTotal:!0,showRange:!0},toolbar:{show:!1},"expandable-rows":!1,filtering:!1,rowSize:"sm",striped:!1,dropDownPerPageOptions:[5,10,25,50],"multi-select":!1,"radio-select":!1,"break-extra-columns":!1,"search-in-backend":!0,showView:!1,showEdit:!0,showDelete:!0,actions:e.customAction,onView:R,onEdit:O,onDelete:V,onRestore:q,onSearch:Y,onChangePage:F,"onUpdate:perPage":G,onRefresh:k(g)},{"left-buttons":y(()=>[C(A,{class:"btn btn-success btn-sm",onClick:$,style:{"font-size":"1.2rem"}},{icon:y(()=>[C(a,{icon:["fas","plus"]})]),default:y(()=>[t[1]||(t[1]=U(" New User "))]),_:1})]),"column-recordStatus":y(({row:i})=>{var l,o;return[w("span",{class:X(["badge",`bg-${((l=i.recordStatus)==null?void 0:l.theme)||"secondary"}`])},Z(((o=i.recordStatus)==null?void 0:o.label)||"N/A"),3)]}),_:1},8,["data","loading","actions","onRefresh"])])])}}};export{nt as default};
