import{useRouter as z}from"./vue-router-Ds9KUoJm.js";import{_ as I}from"./BaseButton-WTmgFy-8.js";import{c as H,b as d}from"./index-CtPaYIeo.js";import{_ as b}from"./form-SOPvTLEN.js";import{g as J,r as S,w as K,o as Q,aj as T,a as W,e as X,i as C,j as Z,O as D,D as _,M as ee,C as $,n as B}from"./@vue-D5jJVPgi.js";import"./pinia-BWRdMQcg.js";import"./bootstrap-r_TW8pGT.js";import"./@popperjs-BEKk9TLb.js";import"./bootstrap-vue-next-CI7J1iGq.js";import"./izitoast-CqdWWGAA.js";import"./sweetalert2-89IKscqO.js";import"./@fortawesome-BMRTUbaC.js";import"./jspdf-BHjgPkY0.js";import"./@babel-BgpAVVkQ.js";import"./fflate-DE92GPtl.js";import"./@vueuse-BFKO5FPz.js";import"./xlsx-VQGdcWwX.js";import"./jspdf-autotable-DwCSpOYb.js";import"./@tsparticles-RHRfPQQI.js";import"./pinia-plugin-persistedstate-BuM6D3kL.js";import"./destr-BPvN1X9m.js";import"./deep-pick-omit-CegYQlcN.js";import"./lodash-CW-aI5JM.js";import"./crypto-js-C9xuVu9R.js";import"./axios-xsH4HHeE.js";import"./qs-Dop67Io4.js";import"./side-channel-DfNisRws.js";import"./es-errors-CxTyLFAO.js";import"./object-inspect-CwG9orBb.js";import"./side-channel-list-CVgrowBt.js";import"./side-channel-map-Czb7NFry.js";import"./get-intrinsic-BpLglCTt.js";import"./es-object-atoms-BR76m4z7.js";import"./math-intrinsics-DP1tGiab.js";import"./gopd-C1lCZ5Qs.js";import"./es-define-property-D_7cP-M3.js";import"./has-symbols-BaUvM3gb.js";import"./get-proto-Cd0SCNDH.js";import"./dunder-proto-DSwuxXkl.js";import"./call-bind-apply-helpers-VtLnLD2e.js";import"./function-bind-CHqF18-c.js";import"./hasown-DwiY0sux.js";import"./call-bound-BuGV4nFB.js";import"./side-channel-weakmap-DmcBNuf_.js";import"./smooth-scrollbar-CSiRJ_Pw.js";import"./core-js-BA3D9nVJ.js";import"./@vueform-b-21xuRD.js";import"./vue3-circle-progress-DRe7pzrA.js";import"./vue-Aiaqh0QQ.js";import"./vue3-apexcharts-CSHbnzTQ.js";import"./apexcharts-AYwITVQt.js";import"./BaseInput-D5f-KaPA.js";/* empty css                                                                  */import"./BaseLabel-WhOZVYgc.js";/* empty css                                                                  */const ae={class:"card p-3"},te={class:"row d-flex justify-content-between align-items-center mb-3"},oe="/v1/iam/rbac/permission",ia={__name:"index",setup(re){const{proxy:g}=J(),w=z(),s=H(),{data:n,request:f,refresh:h,isLoading:k,error:x}=d(oe,{method:"GET",options:{},autoFetch:!1}),u=S({data:[],paginationData:{countOnPage:0,currentPage:1,perPage:25,totalCount:0,totalPages:0,paginationLinks:{}}}),A=[{key:"name",label:"Name"},{key:"description",label:"Description"}];K(n,()=>{v()});const v=()=>{var a;if((a=n.value)!=null&&a.dataPayload){const e=n.value.dataPayload.data;let t=[];typeof e=="object"&&!Array.isArray(e)?t=Object.values(e):Array.isArray(e)&&(t=e),u.value={data:t,paginationData:{countOnPage:n.value.dataPayload.countOnPage||0,currentPage:n.value.dataPayload.currentPage||1,perPage:n.value.dataPayload.perPage||u.value.paginationData.perPage,totalCount:n.value.dataPayload.totalCount||0,totalPages:n.value.dataPayload.totalPages||0,paginationLinks:n.value.dataPayload.paginationLinks||{}}}}},N=async a=>{var i,c;const e=a.name;if(s.toggleModalUsage(!0),await B(),!s.useModal){w.push({name:"iam/permissions/view",params:{id:e}});return}const t=`/v1/iam/rbac/permission/${e}`,{data:o,request:r,isLoading:m,error:l}=d(t,{method:"GET",options:{},autoFetch:!0});await r(),s.openModal(b,{formData:((c=(i=o.value)==null?void 0:i.dataPayload)==null?void 0:c.data)||{},error:l,isLoading:m,readonly:!0,hideSubmit:!0},"View Permission")},p=S({}),U=async a=>{var i,c;const e=a.name;if(p.value={},s.toggleModalUsage(!0),await B(),!s.useModal){w.push({name:"iam/permissions/update",params:{id:e}});return}const t=`/v1/iam/rbac/permission/${e}`,{data:o,request:r,isLoading:m}=d(t,{method:"GET",options:{},autoFetch:!0});await r();const l=async P=>{var L,M;const{data:E,request:Y,error:y}=d(t,{method:"PUT"});if(await Y(P),y.value){console.log("Error",y.value),p.value=y.value;return}s.closeModal(),g.$showAlert({title:"Success",icon:"success",text:((M=(L=E.value)==null?void 0:L.alertifypayload)==null?void 0:M.message)??"Permissions Updated successfully",showConfirmButton:!1,timer:2e3,timerProgressBar:!0}),h()};s.openModal(b,{formData:((c=(i=o.value)==null?void 0:i.dataPayload)==null?void 0:c.data)||{},error:p,isLoading:m,readonly:!1,hideSubmit:!1,onSubmit:l},"Edit Permission")},O=async()=>{if(p.value={},s.toggleModalUsage(!0),await B(),!s.useModal){w.push({name:"iam/permissions/create"});return}const a=async e=>{var l,i;const t="/v1/iam/permissions",{data:o,request:r,error:m}=d(t,{method:"POST"});if(await r(e),m.value){console.log("Error",m.value),p.value=m.value;return}s.closeModal(),g.$showAlert({title:"Success",icon:"success",text:((i=(l=o.value)==null?void 0:l.alertifypayload)==null?void 0:i.message)??"Permissions Created successfully",showConfirmButton:!1,timer:2e3,timerProgressBar:!0}),h()};s.openModal(b,{formData:{},error:p,isLoading:!1,readonly:!1,hideSubmit:!1,onSubmit:a},"Create Permission")},V=async a=>{var l,i;const e=a.id,t=a.is_deleted,o=t?"Restore":"Delete",r=t?"You are about to restore this record. Do you want to proceed?":"You are about to delete this record. Do you want to proceed?";if((await g.$showAlert({title:"Are you sure?",text:r,icon:"warning",showConfirmButton:!0,confirmButtonText:`Yes, ${o} it!`,cancelButtonText:"No, cancel!",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",reverseButtons:!0})).isConfirmed)try{const{data:c,request:P,isLoading:E}=d(`/v1/iam/permissions/${e}`,{method:"DELETE"});await P(),c.value&&await g.$showAlert({title:`${o}d!`,text:((i=(l=c.value)==null?void 0:l.toastPayload)==null?void 0:i.toastMessage)||"Record deleted successfully",icon:"success",showCancelButton:!1,showConfirmButton:!1,timer:1500})}catch{console.error("Error deleting record:",x),await g.$showAlert({title:"Error!",text:`Error deleting record: ${x.value}`,icon:"error",showCancelButton:!1})}finally{await h()}else console.log("Deletion cancelled")},R=a=>{f(null,{page:u.value.paginationData.currentPage,"per-page":u.value.paginationData.perPage,_search:a})},q=async a=>{await f(null,{page:a,"per-page":u.value.paginationData.perPage}),v(),console.log("Page changed to: ",n.value)},j=async a=>{u.value.paginationData.perPage=a,await f(null,{page:u.value.paginationData.currentPage,"per-page":a}),v()},G=async(a,e)=>{const{request:t,error:o,isLoading:r}=d(a,{method:"PUT"});return await t(e),o.value?{error:o.value.message,isLoading:r.value}:{success:!0,isLoading:r.value,shouldRefresh:!0}},F=[{key:"description",onSave:async(a,e)=>{const t={name:e.name,description:a,...e.ruleName&&{ruleName:e.ruleName}},o=`/v1/iam/rbac/permission/${e.name}`,r=await G(o,t);return h(),r}}];return Q(()=>{f().then(()=>{v()})}),(a,e)=>{const t=T("font-awesome-icon"),o=T("OmniGridView");return X(),W("div",ae,[C("div",te,[e[2]||(e[2]=C("div",{class:"col-auto"},[C("h1",{class:"h4 mt-2"},"List of Permissions")],-1)),Z("",!0),D(o,{columns:A,data:u.value,"editable-columns":F,showActionColumn:!1,loading:$(k),dropDownPerPageOptions:[10,25,50],"action-layout":"inline",title:"Permission","pagination-config":{variant:"circle",position:"right",bgColor:"#4f46e5",hoverBgColor:"#6366f1",textColor:"#374151",activeTextColor:"#ffffff",showFirstLast:!0,showNumbers:!0,showTotal:!0,showRange:!0},toolbar:{show:!1,showCreateButton:!1},"expandable-rows":!1,filtering:!1,"multi-select":!1,"radio-select":!1,"break-extra-columns":!0,"search-in-backend":!0,onView:N,onEdit:U,showEdit:!1,onDelete:V,showDelete:!1,onSearch:R,onChangePage:q,"onUpdate:perPage":j,onRefresh:$(f)},{"left-buttons":_(()=>[D(I,{class:"btn btn-success btn-sm",onClick:O,style:{"font-size":"1.2rem"}},{icon:_(()=>[D(t,{icon:["fas","plus"]})]),default:_(()=>[e[1]||(e[1]=ee(" New Permissions "))]),_:1})]),_:1},8,["data","loading","onRefresh"])])])}}};export{ia as default};
